<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Main</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Main.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>Filipe Monteiro (a80229@alunos.uminho.pt)//Jo&#227;o Amaral (a80694@alunos.uminho.pt);</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Main</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Esta &#250;ltima tarefa executa uma compress&#227;o do jogo (a decorrer ou n&#227;o), tornando-a mais compacta para armazenamento.
Executa tamb&#233;m a descompress&#227;o deste, retornando o estado do jogo tal como antes da compresso. Cont&#233;m fun&#231;&#245;es
definidas por nos, mas tamb&#233;m algumas j&#225; existentes no Haskell.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:main">main</a> :: IO ()</li><li class="src short"><a href="#v:calcdimensao">calcdimensao</a> :: [String] -&gt; Int</li><li class="src short"><a href="#v:encode">encode</a> :: [String] -&gt; String</li><li class="src short"><a href="#v:auxencode2">auxencode2</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:auxencode1">auxencode1</a> :: [String] -&gt; String</li><li class="src short"><a href="#v:auxencode">auxencode</a> :: String -&gt; String</li><li class="src short"><a href="#v:decode">decode</a> :: String -&gt; [String]</li><li class="src short"><a href="#v:expandir">expandir</a> :: String -&gt; String</li><li class="src short"><a href="#v:fromDigInt">fromDigInt</a> :: String -&gt; String</li><li class="src short"><a href="#v:linhas">linhas</a> :: Int -&gt; Int -&gt; [String]</li><li class="src short"><a href="#v:juntaParte">juntaParte</a> :: String -&gt; String -&gt; String</li><li class="src short"><a href="#v:juntaTotal">juntaTotal</a> :: [String] -&gt; String -&gt; [String]</li><li class="src short"><a href="#v:mapa_modInicial">mapa_modInicial</a> :: String -&gt; String</li><li class="src short"><a href="#v:mapa_modIntermedio">mapa_modIntermedio</a> :: String -&gt; String</li><li class="src short"><a href="#v:contagem">contagem</a> :: String -&gt; Int</li><li class="src short"><a href="#v:coordsDownParte">coordsDownParte</a> :: String -&gt; String</li><li class="src short"><a href="#v:coordsDownTotal">coordsDownTotal</a> :: String -&gt; [String]</li><li class="src short"><a href="#v:ex">ex</a> :: [[Char]]</li><li class="src short"><a href="#v:ex2">ex2</a> :: [[Char]]</li><li class="src short"><a href="#v:ex3">ex3</a> :: [[Char]]</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:main" class="def">main</a> :: IO ()</p></div><div class="top"><p class="src"><a name="v:calcdimensao" class="def">calcdimensao</a> :: [String] -&gt; Int</p><div class="doc"><p>Trata-se de uma fun&#231;&#227;o que recebe um mapa, nomeadamente o que est&#225; a ser utilizado e calcula a sua dimens&#227;o a partir do primeiro elemento da lista, que se trata da primeira linha.</p><h1>Explica&#231;&#227;o da fun&#231;&#227;o:</h1><ol><li>Recebe uma [<a href="String.html">String</a>] que se trata do mapa em utiliza&#231;&#227;o.</li><li>Recorre &#225; fun&#231;&#227;o length e aplica-a &#225; cabe&#231;a da lista pois para determinar a dimens&#227;o apenas necessitamos de um elemento da [<a href="String.html">String</a>] (uma linha)</li></ol><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[&quot;###############&quot;,&quot;#    ?   ? ?  #&quot;,&quot;# # #?#?# #?# #&quot;,&quot;#?  ? ?       #&quot;,&quot;#?# #?#?#?# # #&quot;,&quot;# ?   ??      #&quot;,&quot;# # # #?#?#?#?#&quot;,&quot;#  ??     ? ? #&quot;,&quot;# # #?# # #?# #&quot;,&quot;#???       ?  #&quot;,&quot;# # #?# #?# #?#&quot;,&quot;#  ?     ?  ? #&quot;,&quot;# #?# #?# #?# #&quot;,&quot;#       ??    #&quot;,&quot;###############&quot;,&quot;+ 12 7&quot;,&quot;! 7 12&quot;,&quot;! 8 13&quot;,&quot;! 9 13&quot;,&quot;* 7 4 1 1 10&quot;,&quot;3 7 4&quot;,&quot;0 2 1&quot;]
</code></strong> = 15  
</pre></div></div><div class="top"><p class="src"><a name="v:encode" class="def">encode</a> :: [String] -&gt; String</p><div class="doc"><p>Trata-se de uma fun&#231;&#227;o que comprime o estado atual do jogo.
Devido a existirem carat&#233;res que s&#227;o im&#245;veis (como as paredes a.k.a '#') estes s&#227;o instantan&#234;amente eliminados do mapa.
Os espa&#231;os e os carateres especiais s&#227;o substiu&#237;dos pelo carat&#233;r <code>p</code>.
&#201; de referencia tamb&#233;m que pretendemos manter as coordenadas do mapa tal como est&#227;o, logo foi feita uma condi&#231;&#227;o que diz que se o ultimo elemento de um dos elemntos da [<a href="String.html">String</a>]
n&#227;o for igual a '#' ent&#227;o ele vai devolver esse elemento e aplicar novamente a fun&#231;ao recursivamente, separando as coordenadas umas das outras com uma barra.</p><h2>Explica&#231;&#227;o da fun&#231;&#227;o:</h2><ol><li>&#201; fornecido &#224; fun&#231;&#227;o encode o mapa em causa, de seguida, &#233; utilizada a fun&#231;ao &quot;calcdimensao&quot; desse mesmo mapa e depois a fun&#231;&#227;o &quot;show&quot; para que o n&#250;mero que a fun&#231;&#227;o
calcdimensao nos fornece seja transformado em <a href="String.html">String</a>.</li></ol><ol><li>De seguida adiciona uma '|' para que seja separado o valor da dimensao do mapa comprimido.</li><li>Logo ap&#243;s &#225; aplica&#231;&#227;o do n&#250;mero da dimens&#227;o e da barra, a fun&#231;&#227;o recorre a uma fun&#231;&#227;o auxiliar &quot;auxencode1&quot;.</li><li>A fun&#231;&#227;o &quot;auxencode1&quot; verifica se os elementos da [<a href="String.html">String</a>] constituem o mapa em si, comparando o <strong>&#250;ltimo</strong> elemento desse elemento da [<a href="String.html">String</a>] a um &quot;#&quot;, se
este for igual ent&#227;o &#233; aplicada a fun&#231;&#227;o &quot;auxencode&quot; que examina todos os elementos da <a href="String.html">String</a> que pertence &#224; [<a href="String.html">String</a>]. Se este for &quot;#&quot; ent&#227;o s&#227;o eliminados, se for igual a ' '
ent&#227;o &#233; substitu&#237;do por um char = <code>e</code>, se n&#227;o verificar nenhum destes casos ent&#227;o ser&#225; substitu&#237;do por um char = <code>c</code>.</li><li>Se na fun&#231;&#227;o &quot;auxencode1&quot; n&#227;o for verificada a condi&#231;&#227;o de o &#250;ltimo elemento de um elemento da [<a href="String.html">String</a>] ent&#227;o a fun&#231;&#227;o vai devolver o elemento a ser avaliado	
pela fun&#231;&#227;o e adicionar uma &quot;|&quot; e ap&#243;s isto, fazer novamente a fun&#231;&#227;o &quot;auxencode1&quot;.</li><li>Foi feita esta separa&#231;&#227;o pois quer&#237;amos manter as coordenadas do jogo tal e qual como estavam na [<a href="String.html">String</a>].</li></ol></div></div><div class="top"><p class="src"><a name="v:auxencode2" class="def">auxencode2</a> :: String -&gt; Int -&gt; String</p></div><div class="top"><p class="src"><a name="v:auxencode1" class="def">auxencode1</a> :: [String] -&gt; String</p></div><div class="top"><p class="src"><a name="v:auxencode" class="def">auxencode</a> :: String -&gt; String</p></div><div class="top"><p class="src"><a name="v:decode" class="def">decode</a> :: String -&gt; [String]</p><div class="doc"><p>Pegando no resultado de <strong>encode</strong>, tranforma essa <a href="String.html">String</a> do mapa num mapa igual ao original (<strong>antes</strong> do encode)</p><pre>Syntax --&gt; <strong>decode</strong> mapa = . . .
</pre></div></div><div class="top"><p class="src"><a name="v:expandir" class="def">expandir</a> :: String -&gt; String</p><div class="doc"><p>Quando encontra um n&#186;, <strong>replica</strong> <em>esse n&#186; de vezes</em> <em><code>e</code></em></p><p>Se encontrar um <code>c</code>, n&#227;o faz nada</p><pre>Syntax --&gt; <strong>expandir</strong> (encoded mapa) = . . .
</pre></div></div><div class="top"><p class="src"><a name="v:fromDigInt" class="def">fromDigInt</a> :: String -&gt; String</p><div class="doc"><p>Na nossa fun&#231;&#227;o encode, no inicio da nova <a href="String.html">String</a> tem um n&#250;mero e logo a seguir um &quot;|&quot; (para <strong>separar</strong> a dimens&#227;o dos demais caracteres)</p><p><strong>fromDig_Int</strong> d&#225; como resultado uma <a href="String.html">String</a> com o n&#250;mero</p><h2>Nota</h2><p>Existe uma fun&#231;&#227;o no ghci que apresenta um n&#250;mero presente numa <a href="String.html">String</a> na forma de <a href="Inteiro.html">Inteiro</a>: <strong>read ()::Int</strong>, mas <strong>apenas</strong>
pode ter n&#250;meros dentro dessa <a href="String.html">String</a>, sen&#227;o d&#225; <strong>erro</strong> (no nosso caso, a <a href="String.html">String</a> tem n&#250;meros e caracteres) </p><pre>Syntax --&gt; <strong>fromDigInt</strong> (encoded mapa)
</pre></div></div><div class="top"><p class="src"><a name="v:linhas" class="def">linhas</a> :: Int -&gt; Int -&gt; [String]</p><div class="doc"><p>Fun&#231;&#227;o com a base da fun&#231;&#227;o <strong>linhas</strong> da &quot;Tarefa 1&quot;, mas com uma mudan&#231;a nos primeiros caracteres da primeira, segunda,
penultima e &#250;ltima linhas: para as fun&#231;&#245;es, ao usarem o resultado desta fun&#231;&#227;o, 
nao usarem os espa&#231;os <strong>especiais&quot;</strong> (onde <strong>n&#227;o</strong> pode ter nada), o resuldao ada <strong>linhas</strong> ser&#225; uma [<a href="String.html">String</a>], onde, por exemplo:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>linha 1 --&gt; &quot;#nnrrrnn#&quot; , n==espa&#231;o especial       r==espa&#231;o a ser substituido
</code></strong></pre><h2>Nota</h2><pre>Temos um caso especial para quando <strong>n==5</strong>, pelos motivos apresentados na Tarefa 1
</pre><pre>Syntax --&gt; <strong>linhas</strong> n 0 = . . .
</pre></div></div><div class="top"><p class="src"><a name="v:juntaParte" class="def">juntaParte</a> :: String -&gt; String -&gt; String</p><div class="doc"><p>Pegando numa <em>linha do mapa</em> e na <em>string do encode</em>, substitui cada caracter com &quot;r&quot; ou &quot;n&quot; da <strong>linha</strong>
por uma letra da <strong>string do encode</strong> (e=&quot; &quot; &amp;&amp; c=&quot;?&quot; )</p><h2>Exemplo</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>juntaParte &quot;#  rrrrrrrrr  # &quot;eeeeepeeeepeeeepeeeepeepeeepeppe&quot; = &quot;#  eeeeepeee  #&quot;
</code></strong></pre><pre>Syntax --&gt; <strong>juntaParte</strong> list = . . .
</pre></div></div><div class="top"><p class="src"><a name="v:juntaTotal" class="def">juntaTotal</a> :: [String] -&gt; String -&gt; [String]</p><div class="doc"><p>Faz o mesmo que <strong>juntaParte</strong>, mas aplicado a um mapa ([<a href="String.html">String</a>]) usando a <strong>juntaParte</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Exemplo: juntaTotal [&quot;#  rrrrrrrrr  #&quot;,&quot;#r#r#r#r#r#r#r#&quot;] &quot;eeeeepeeeepeeeepeeeepeepeeepep&quot; = [&quot;#  eeeeepeee  #&quot;,&quot;#e#p#e#e#e#e#e#&quot;]
</code></strong></pre><pre>Syntax --&gt; <strong>juntaTotal</strong> list (encoded mapa) = . . .
</pre></div></div><div class="top"><p class="src"><a name="v:mapa_modInicial" class="def">mapa_modInicial</a> :: String -&gt; String</p><div class="doc"><p>Esta e a pr&#243;xima t&#234;m efeitos parecidos, apenas com algumas mudan&#231;as devidos a condi&#231;&#245;es diferentes. 
Ambas apresentam uma <a href="String.html">String</a> sem <strong>tudo</strong> o que est&#225; at&#233; a um &quot;|&quot;.</p></div></div><div class="top"><p class="src"><a name="v:mapa_modIntermedio" class="def">mapa_modIntermedio</a> :: String -&gt; String</p></div><div class="top"><p class="src"><a name="v:contagem" class="def">contagem</a> :: String -&gt; Int</p><div class="doc"><p>Conta o n&#186; de caracteres para serem substituidos existentes naquela linha
para depois retirar esse n&#186; de caracteres da <a href="String.html">String</a> do encode</p><p>Ser&#227;o <strong>&quot;r&quot;</strong> e <strong>&quot;n&quot;</strong></p></div></div><div class="top"><p class="src"><a name="v:coordsDownParte" class="def">coordsDownParte</a> :: String -&gt; String</p><div class="doc"><p>Pega na <a href="String.html">String</a> do encode e apresenta apenas a parte desta
com as coordenadas de <em>powerups</em>, <em>bombas</em> e <em>players</em></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>= &quot;|+ 3 3|! 5 5|* 7 7 1 1 10|0 4 3 +|1 7 7&quot;
</code></strong></pre></div></div><div class="top"><p class="src"><a name="v:coordsDownTotal" class="def">coordsDownTotal</a> :: String -&gt; [String]</p><div class="doc"><p>Pegando no resultado de <strong>coordsDownParte</strong> e d&#225; como resultado uma
lista de <a href="String.html">String</a> com cada coordenada</p></div></div><div class="top"><p class="src"><a name="v:ex" class="def">ex</a> :: [[Char]]</p><div class="doc"><h1>Exemplo:</h1><ol><li>Mapa: [&quot;########<a name="&quot;,&quot;"></a>       <a name="&quot;,&quot;"></a> <a name="?"></a> <a name=" "></a>&quot;,&quot;<a name="     ? "></a>&quot;,&quot;<a name="?"></a> <a name=" "></a>?<a name="&quot;,&quot;"></a> ?  ?  <a name="&quot;,&quot;"></a> <a name="?"></a>?<a name=" "></a>&quot;,&quot;<a name="  ??   "></a>&quot;,&quot;#########&quot;,&quot;+ 3 3&quot;,&quot;! 5 5&quot;,&quot;* 7 7 1 1 10&quot;,&quot;0 4 3 +&quot;,&quot;1 7 7&quot;]  </li><li>length (concat mapa) = 115 </li><li>encode mapa = &quot;9|eeeeeeeeceeeeeeececeececeeceeecceeecceee|+ 3 3|! 5 5|* 7 7 1 1 10|0 4 3 +|1 7 7&quot;</li><li>length (encode mapa) = 81 </li><li>Redu&#231;&#227;o = ((81 / 115) * 100) - 100 = 30% (aproximadamente)</li></ol><p>Mais exemplos de teste</p></div></div><div class="top"><p class="src"><a name="v:ex2" class="def">ex2</a> :: [[Char]]</p></div><div class="top"><p class="src"><a name="v:ex3" class="def">ex3</a> :: [[Char]]</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>